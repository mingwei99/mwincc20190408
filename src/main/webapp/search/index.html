<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
    <title>中国合规商品资质验证管理中心查询平台</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="../css/all-bg.css" type="text/css">
    <link rel="stylesheet" href="../css/home.css" type="text/css">
    <link rel="stylesheet" href="../css/list.css" type="text/css">
    <link rel="stylesheet" href="../css/upload.css">
    <link rel="stylesheet" href="../css/upload1.css">

    <style type="text/css">
        .divcss5 img{ width:150px; height:150px}
        div.file{display:inline-block;position:relative;}
        div.file input.transparent{position:absolute;left:0;top:0;filter:alpha(opacity=0);opacity:0;width:100%}
        <!--

        body {
            background-color: #fefffe;
        }
        -->
        .tdd{
            width: 110px;
            height: 168px;
        }
        .button_1 {background: url(../images/top-search.png) ;width: 50px;height: 38px;}
        .navi-form .top-searchbtn {
            width: 40px;
            height: 38px;
            background-image: url(../images/top-search.png);
            background-repeat: no-repeat;
            background-position: 50% 50%;
            outline: none;
            margin-left: 0px !important;
            background-color: #3D8DE2;
        }
        .input-group-btn > .btn {
            position: relative;
            width: 48px;
        }

    </style>

    <!--
      <script src="../js/jquery-1.8.3.min.js"></script>-->
    <script type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="../js/upload.min.js"></script>

    <script type="text/javascript">

        function doUpload() {

            var location = (window.location+'').split('/');
            var basePath = location[0]+'//'+location[2]+'/'+location[3];
            var ff = basePath+"/file/upload_r/1/1";

            var files = $("#imageFile").get(0).files[0]; //获取file控件中的内容

            var fd = new FormData();
            fd.append("errPic", files);


            $.ajax({
                //url: '<%=basePath%>UploadImage' ,  /*这是处理文件上传的servlet*/
                url: ff ,  /*这是处理文件上传的servlet*/
                type: 'POST',
                data: fd,
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (returndata) {

                    document.getElementById("businessLicense").value=JSON.stringify(returndata.result);
                    //document.getElementById("businessLicense1").value=JSON.stringify(returndata.result);

                    document.getElementById("upimg").src=returndata.result.url;
                    //document.getElementById("showpic").src="<%=basePath%>UploadImage?picture=showpic";/*这是预览图片用的，自己在文件上传表单外添加*/
                },
                error: function (returndata) {
                    alert(34);
                    alert(returndata);
                }
            });
        }



        function doUpload1() {
            document.getElementById("imageFile").click();
        }


        var loginForm = document.getElementById("loginForm");
        function login() {
            loginForm.submit();
        }
        function reset() {
            loginForm.reset();
        }

        function chackErr() {
            var myErr = GetQueryString("err");
            if (myErr != null  && myErr.toString().length > 0) {
                //alert(myErr.toString());
                if(myErr == "1"){
                    var errText = "<span style=\"color: red\">用户名或密码错误！</span>";
                } else {
                    var errText = "<span style=\"color: red\">验证码错误！</span>";
                }
                document.getElementById("loginErr").innerHTML = errText;
            }
        }
        function GetQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null)return unescape(r[2]);
            return null;
        }

        $("#captcha").keydown(function (e) {
            if (e.keyCode == 13) {
                login();
            }
        });
        chackErr();


        //邮箱 验证
        function checkEmail() {
            var reg = new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$"); //正则表达式
            var obj = document.getElementById("mail"); //要验证的对象

            document.getElementById('msgEmail').innerHTML='';
            if(obj.value === ""){ //输入不能为空
                //alert("输入不能为空!");
                return false;
            }else if(!reg.test(obj.value)){ //正则验证不通过，格式不对
                //alert("邮箱格式验证不通过!");
                document.getElementById('msgEmail').innerHTML='邮箱格式验证不通过';
                return false;
            }else{
                //alert("通过！");
                return true;
            }
        }
        //cloneEmail //邮箱 验证 清空
        function cloneEmail() {
            document.getElementById('msgEmail').innerHTML='';
        }

        //验证联系电话
        function checkMobile(str) {
            str =  document.getElementById("phone").value;
            var rl = "";
            if(str!=''){
                var re = /^1\d{10}$/; //手机验证
                if (re.test(str)) {
                    //alert("手机正确");
                } else {
                    rl = '手机验证不通过';
                }
                if(rl.length>0){
                    var rer = /^0\d{2,3}-?\d{7,8}$/;//座机验证
                    if(rer.test(str)){
                        //alert("座机正确");
                        rl = "";
                    }else{
                        rl = '联系电话验证不通过';
                    }
                }
                if(rl.length>0){
                    document.getElementById('msgPhone').innerHTML=rl;
                }
            }
        }

        //cloneEmail //邮箱 验证 清空
        function cloneMobile() {
            document.getElementById('msgPhone').innerHTML='';
        }


        //验证密码
        function checkPass(str) {
            document.getElementById('msgPass').innerHTML='';
            var password =  document.getElementById("password").value;
            var password2 =  document.getElementById("password2").value;
            var rl = "";
            if(password!=password2){
                document.getElementById('msgPass').innerHTML="两次密码不一致";
            }
        }

        //cloneEmail //密码 验证 清空
        function clonePass() {
            document.getElementById('msgPass').innerHTML='';
        }

        //验证用户
        function checkName(){

            document.getElementById('msgName').innerHTML='';
            var name =  document.getElementById("name").value;

            //alert(name);
            var location = (window.location+'').split('/');
            var basePath = location[0]+'//'+location[2]+'/'+location[3];
            var ff = basePath+"/manager/user/getUserByName";


            var data = {
                name:$('#name').val(),
                type:"用户"
            }

            $.ajax({
                type:'POST',
                url:ff ,
                data:JSON.stringify(data),//必要
                dataType:"json",
                contentType:"application/json",
                async:false,
                cache:false,
                success: function (data) {
                    //alert(returndata.returnCode);
                    var code = data.returnCode;
                    if( data.returnCode=="500"){
                        document.getElementById('msgName').innerHTML="该用户已被使用.";
                    }
                    //document.getElementById("upimg").src=returndata.result.url;
                    //document.getElementById("showpic").src="<%=basePath%>UploadImage?picture=showpic";/*这是预览图片用的，自己在文件上传表单外添加*/
                },
                error: function (data) {
                    document.getElementById('msgName').innerHTML="查询用户失败.";
                    //alert(returndata);
                }
            });

        }

        //cloneEmail //用户 验证 清空
        function cloneName() {
            document.getElementById('msgName').innerHTML='';
        }

        //clonePicCode


        //cloneEmail //验证码 清空
        function clonePicCode() {
            document.getElementById('msgPicCode').innerHTML='';
        }

        //查询 sel()
        function sel() {

            var location = (window.location+'').split('/');
            var basePath = location[0]+'//'+location[2]+'/'+location[3];
            var ff = basePath+"/manager/commodity/query_";

            var a_url= 'http://icon.cfcpincc.com/incc/commodity/';
            if(location.hostname=='localhost'){
                a_url= 'http://192.168.1.3:8081/incc/commodity/';
            }

            var data = {
                name:$('#tiaojiao').val(),
                type:"用户"
            }

            $.ajax({
                type:'POST',
                url:ff ,
                data:JSON.stringify(data),//必要
                dataType:"json",
                contentType:"application/json",
                async:false,
                cache:false,
                success: function (data) {
                    var divA = document.getElementById("chaxunsl");
                    //divA.innerHTML = divA.innerText+'追加的内容s';
                    divA.innerHTML ='小查为您找到'+data.total+'条符合条件的商品';
                    //divA.innerHTML = divA.innerHTML+'<h3>追加内容为H3字体</h3>';

                    if(data) {
                        var res = [];
                        //res.push('<thead> <tr id="search-tab-title"> <td width="110px" height="42px">公司</td> <td width="710px"></td> <td width="100px">状态</td> </tr> </thead><tbody>');
                        res.push('<tbody>');
                        var num = 1;
                        jQuery.each(data.list, function (i, item) {
                            var r = item.pic;
                            var picUrl = r.substring(r.indexOf('url":"')+6,r.indexOf('"ext"')-2);

                            res.push('<tr>');
                            //res.push('<td align="center" ><a href="http://icon.cfcpincc.com/incc/commodity/'+item.id+'"><img width="80px" height="80px" src="'+picUrl+'"></a></td>');
                            //res.push('<td border="0.5"  width="110px" height="196px" align="center"><a href="http://192.168.1.3:8081/incc/commodity/'+item.id+'" target="_blank"><img width="80px" height="80px" src="'+picUrl+'"></a></td>');
                            res.push('<td border="0.5"  width="110px" height="196px" align="center"><a href="'+a_url+item.id+'" target="_blank"><img width="80px" height="80px" src="'+picUrl+'"></a></td>');
                            /*res.push('<td align="center" >' + item.id + '</td>');*/
                            res.push('<td><p>商品名称 ：' + item.name + '</p><p>经营企业 ：'+item.company.name+'</p></td>');


                            //res.push('<th>经营企业 ：' + item.company.name + '</th>');

                            /*
                            res.push('<td align="center" >' + item.CWFYXM + '</td>');
                            res.push('<td align="center" >' + item.CWFY + '</td>');*/


                            res.push('<td align="center">' + item.statusValue + '</td>');
                            res.push('</tr>');

                            num++;
                        });
                        //$("#fylistDatas").empty().html(res.join(""));
                        res.push('</tbody>');
                        $("#fylistDatas").empty().html(res);
                    }

                    //alert(returndata.returnCode);
                    var code = data.returnCode;
                    if( data.returnCode=="500"){
                        document.getElementById('msgName').innerHTML="该用户已被使用.";
                    }
                    //document.getElementById("upimg").src=returndata.result.url;
                    //document.getElementById("showpic").src="<%=basePath%>UploadImage?picture=showpic";/*这是预览图片用的，自己在文件上传表单外添加*/
                },
                error: function (data) {
                    document.getElementById('msgName').innerHTML="查询用户失败.";
                    //alert(returndata);
                }
            });

        }

    </script>

    <table width="100%" height="58" border="0" align="center" cellpadding="0" cellspacing="0" class="top_box">
        <tr>
            <td align="center" bgcolor="#FFFFFF">
                <table width="100%" height="58" border="0" align="center" cellpadding="0" cellspacing="0"
                       background="../images/topbg.png">
                    <tr>
                        <td width="524" align="left" class="nav_topfont">
                            <a href="" class="A_blue"></a><img
                                src="../images/logo-banner.png" height="58" border="0">
                        </td>
                        <td width="524" align="left" class="nav_topfont">

                            <!--

                                                    <form class="navi-form" role="search" action="">
                            -->

                            <input type="text" id="tiaojiao" style="width: 400px; height: 34px;font-size: 14px;" placeholder="请输入商品名称，经营主体，生产主体，品牌名称，多关键词用空格隔开，如“38度建国原浆 建国酒业”"  value=""/>


                            <!--<input id="headerKey" name="key" onkeydown="searchKeydown(event,2);" class="form-control headerKey" style="font-size: 14px;" type="text" placeholder="请输入企业名称、人名，产品名等，多关键词用空格隔开，如“小米 雷军”" value="联达动力" autocomplete="off">
                            -->

                            <!--<input type="button" id="cx" class="btn btn-primary top-searchbtn" value="">-->
                            <button class="button_1" id="cx"  type="button"  onclick="sel();"  class="btn btn-primary top-searchbtn" >搜索</button>



                        </td>
                        <td width="436" align="right" class="nav_topfont"><p>&nbsp;</p>
                            <p>中国保护消费者基金会 &nbsp;&nbsp;</p>

                            <a href="http://www.cfcpincc.com"  target="_blank"><span style="font-size:12px;text-decoration:none;">网站首页&nbsp;&nbsp;</span></a>
                            <a href="http://icon.cfcpincc.com"  target="_blank"><span style="font-size:12px;text-decoration:none;">后台登录&nbsp;&nbsp;&nbsp;&nbsp;</span></a>
                        </td>
                    </tr>

                </table>
            </td>
        </tr>
    </table>
</head>

<div>
<p>&nbsp;</p>


<table style="border: solid thin rgba(217,207,255,0.1)" width="97%" border="1" align="center" cellpadding="0" cellspacing="0">
    <thead>
    <tr> <th colspan="3" height="66px" align="left"><div id="chaxunsl">小查为您找到条符合条件的商品</div></th> </tr>
    <tr> <th  width="70px" height="42px">商品图片</th> <th>商品信息</th> <th width="100px">发布状态</th> </tr>

    </thead>
<tbody id="fylistDatas">
</tbody >
</table>
   <!--
    <ul class="ant-pagination ant-table-pagination" unselectable="unselectable">
        <li title="上一页" tabindex="0" class=" ant-pagination-prev" aria-disabled="false"><a></a></li>
        <li title="1" class="ant-pagination-item ant-pagination-item-1" tabindex="0"><a>1</a></li>
        <li title="2" class="ant-pagination-item ant-pagination-item-2" tabindex="0"><a>2</a></li>
        <li title="3" class="ant-pagination-item ant-pagination-item-3 ant-pagination-item-active" tabindex="0"><a>3</a></li>
        <li title="4" class="ant-pagination-item ant-pagination-item-4" tabindex="0"><a>4</a></li>
        <li title="下一页" tabindex="0" class=" ant-pagination-next" aria-disabled="false"><a></a></li>&lt;!&ndash; react-empty: 576 &ndash;&gt;
    </ul>-->
<br>
<br>
<br>
<br>
</div>
<footer>
    <table width="100%" height="40" border="0" cellpadding="0" cellspacing="0" class="lg_bottom">
        <tr>
            <td align="center" valign="top" class="songgray12">Copyright © 2017-2018 中国合规商品资质验证中心 版权所有 备案号：京ICP备18047684号-1 商验（北京）认证服务有限公司提供技术和运营服务</td>
        </tr>
    </table>
</footer>
<script  type="text/javascript">
    var loginForm = document.getElementById("loginForm");
    function login() {
        //loginForm.submit();
        var distributor_text = $('#s1234 option:selected').text();//选中的文本
        var distributor_val = $('#s1234 option:selected') .val();//选中的值


        //"distributorId":$('#s1234 option:selected').val(),
        //"businessLicense":$('#businessLicense').val(),
        //"password": $('#password').val(),
        //"mail":$('#mail').val(),
        //"idCard":$('#idCard').val(),
        //"distributor":null,
        //"state":null,
        //"phone":$('#phone').val(),
        //"companyName":$('#companyName').val(),
        // 这里传送的对象有多少属性，就要传送多少属性
        // 所以一般都设计DTO

        var rr = $('#companyName').val();

        var data = {
            name:$('#name').val(),
            distributorId:$('#s1234 option:selected').val(),
            password: $('#password').val(),
            password2: $('#password2').val(),
            mail:$('#mail').val(),
            idCard:$('#idCard').val(),
            companyName:$('#companyName').val(),
            phone:$('#phone').val(),
            businessLicense:JSON.stringify($('#businessLicense').val()),
            yzm:$('#yzm').val()
        }
        //alert(JSON.stringify(data));
        var location = (window.location+'').split('/');
        var basePath = location[0]+'//'+location[2]+'/'+location[3];
        var ff = basePath+"/manager/user/saveUser_rici";

        $.ajax({
            type:'POST',
            url:ff ,
            data:JSON.stringify(data),//必要
            dataType:"json",
            contentType:"application/json",
            async:false,
            cache:false,
            success:function (data) {
                //getPicCode();
                var recode = data.returnCode;

                if(data.returnCode=="295"){
                    document.getElementById('msgPicCode').innerHTML='验证码已失效，请重新获取验证码信息';
                }
                if(data.returnCode=="203"){
                    document.getElementById('msgPicCode').innerHTML='验证码错误';
                }
                if(data.returnCode=="205"){
                    document.getElementById('msgName').innerHTML='用户已被使用';
                }
                if(data.returnCode=="207"){
                    document.getElementById('msgName').innerHTML='用户名为空';
                }
                if(data.returnCode=="210"){
                    document.getElementById('msgPass').innerHTML='两次密码不一致';
                }
                if(data.returnCode=="211"){
                    document.getElementById('msgEmail').innerHTML='邮箱验证失败';
                }
                if(data.returnCode=="299"){
                    document.getElementById('msgEmail').innerHTML='邮箱为空';
                }
                if(data.returnCode=="298"){
                    document.getElementById('msgPhone').innerHTML='联系电话为空';
                }
                if(data.returnCode=="212"){
                    document.getElementById('msgPhone').innerHTML='联系电话验证失败';
                }
                if(data.returnCode=="213"){
                    document.getElementById('msgCompany').innerHTML='企业名称已被其他用户注册使用*';
                }
                if(data.returnCode=="214"){
                    document.getElementById('msgCompany').innerHTML='企业名称为空';
                }
                if(data.returnCode=="215"){
                    document.getElementById('msgIdCard').innerHTML='身份证为空';
                }
                if(data.returnCode=="216"){
                    document.getElementById('msgIdCard').innerHTML='身份证长度不足18位';
                }
                if(data.returnCode=="217"){
                    document.getElementById('msgIdCard').innerHTML='身份证验证失败';
                }
                if(data.returnCode=="296"){
                    document.getElementById('msgIdCard').innerHTML='身份证号的第1-17位含有非数字的字符';
                }
                if(data.returnCode=="297"){
                    document.getElementById('msgIdCard').innerHTML='身份证号的出生日期非法';
                }
                if(data.returnCode=="200"){
                    alert("您已注册成功，我们会在15个工作日审核您的注册信息，请您保持电话畅通。详情致电010-65135566转2706");
                }
                if(data.status=="success"){
                    console.debug('----------------插入数据库成功------------------');
                }else{
                    console.debug('----- ----------插入数据库失败------------------');
                }
                //getPicCode();
            },
            error:function (data) {
                var dd = data;
                alert("注册失败，请联系管理员！");
                //getPicCode();
            }
        });

    }
    function reset() {
        loginForm.reset();
    }

    function chackErr() {
        var myErr = GetQueryString("err");
        if (myErr != null  && myErr.toString().length > 0) {
            //alert(myErr.toString());
            if(myErr == "1"){
                var errText = "<span style=\"color: red\">用户名或密码错误！</span>";
            } else {
                var errText = "<span style=\"color: red\">验证码错误！</span>";
            }
            document.getElementById("loginErr").innerHTML = errText;
        }
    }
    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null)return unescape(r[2]);
        return null;
    }

    $("#captcha").keydown(function (e) {
        if (e.keyCode == 13) {
            login();
        }
    });
    chackErr();


    window.onload = function() {
        var location = (window.location+'').split('/');
        var basePath = location[0]+'//'+location[2]+'/'+location[3];
        var ff = basePath+"/manager/distributor/options_rg";

        var fd = new FormData();
        $.ajax({
            //url: '<%=basePath%>UploadImage' ,  /*这是处理文件上传的servlet*/
            url: ff ,  /*这是处理文件上传的servlet*/
            type: 'POST',
            data: fd,
            async: false,
            cache: false,
            contentType: false,
            processData: false,
            success: function (returndata) {
                var arr = returndata;
                var sel = document.getElementById("s1234");
                for(var i=0;i<arr.length;i++){
                    var dis = arr[i];

                    //先创建好select里面的option元素
                    var option = document.createElement("option");
                    //转换DOM对象为JQ对象,好用JQ里面提供的方法 给option的value赋值
                    $(option).val(arr[i].ID);
                    //给option的text赋值,这就是你点开下拉框能够看到的东西
                    $(option).text(arr[i].NAME);
                    //获取select 下拉框对象,并将option添加进select
                    $('#s1234').append(option);

                }
            },
            error: function (returndata) {
                document.getElementById('msgName').innerHTML="查询用户失败";
                //alert(returndata);
            }
        });
    };


</script>
</html>
